<!DOCTYPE html>
<html lang="zh_CN">
    <head>
        <meta charset="utf-8" />
        <title>状态模式</title>
    </head>
    <body>
        <section>
            <h1>第一个反例：电灯开关</h1>
            <p>虽然这是一个反例，但是我依然要说，当状态的数量、转换路线是稳定的、简单的时候，<code>if-else</code>就是最好的状态机</p>
            <a href="./simple-light.js" target="_blank">源码</a>
            <div>
                <iframe src="./simple-light.html">
                </iframe>
            </div>
        </section>

        <section>
            <h1>改进：状态模式下的“电灯开关”</h1>
            <p>使用状态模式实现“电灯开关”的好处在于，改变状态关系的时候，只需要修改与之相关的状态类。这在一定程度上，更加“开闭原则”一点；它通过state这个类的多态性内化了if-else。</p>
            <p>坏处也很明显，要增加一大堆状态类。另外，我觉得这个还不是很“开闭原则”。</p>
            <a href="./simple-light-with-state-pattern.js" target="_blank">源码</a>
            <div>
                <iframe src="./simple-light-with-state-pattern.html">
                </iframe>
            </div>
        </section>

        <section>
            <h1>第二个反例：文件上传</h1>
            <p>当有多个action的时候，就能更能体现状态模式的优势了！让我们来看看，多action情况下，不使用状态模式是多痛苦的一件事情。</p>
            <a href="./file-upload.js" target="_blank">源码</a>
            <div>
                <iframe src="./file-upload.html">
                </iframe>
            </div>
        </section>

        <section>
          <h1>改进：状态模式下的“文件上传”</h1>
          <p>有了状态模式后，新增、删除状态、修改状态之间的关联，就相对方便多了。</p>
          <p>下面的这个实现当然还有可以改进的地方，比如：每次新增、删除状态，都需要修改init函数，我们可以把新增、删除这个动作“注册”化，这样就相对好一些了。</p>
          <a href="./file-upload-with-state-pattern.js" target="_blank">源码</a>
          <div>
            <iframe src="./file-upload-with-state-pattern.html">
            </iframe>
          </div>
        </section>

        <section>
            <h1>js的状态模式</h1>
            <p>的确，js这种非强类型限制的语言，没太大必要用类来承载“状态”，普通的对象面量就可以了。下面看一下，js版的状态模式下的“点灯开关”</p>
            <a href="./simple-light-with-js-state-pattern.js" target="_blank">源码</a>
            <div>
                <iframe src="./simple-light-with-js-state-pattern.html">
                </iframe>
            </div>
        </section>
    </body>
</html>
