<!DOCTYPE html>
<html lang="zh_CN">

<head>
    <meta charset="utf-8" />
    <title>发布订阅者模式</title>
</head>

<body>
    <section>
        <h1>我的理解</h1>
        <p>我认为，发布订阅者模式存在的原因在于：发布者与订阅者之间的关系是多对多的、是易变的。所以，我们需要将两者解耦。参考，中介者模式，我们引入了一个“中介”，可以称之为“消息中心”。发布者，到上面发布“信息”，订阅者在上面订阅“信息”。</p>
    </section>

    <section>
        <h1>与“观察者”模式的区别</h1>
        <p>我觉得这两种设计模式的核心“手法”是一致的，那就是“信息”的产生者通过一个“关注者”列表来通知关注者。不同的是，“发布订阅模式”比“观察者”模式更进一步：它把“关注者”与“发布者”之间解耦了。这里的解耦指的是没有之间引用关系，也就是很多书爱用的“相互之间不知道‘彼此’存在”的说法。我对“不知道”三个字不是很认同，发布者当然可以不用关心有没有人关注它的消息，但是订阅者难道也不知道有什么发布者存在吗？那它订阅个屁。通俗的说，你，作为一个报纸的订阅者，的的确确不用直接跑到“人m日报”去订阅报纸，但是你总得知道“人x日报”的存在吧？所以，发布订阅者中，订阅者并不是不知道发布者的存在，只是它们直接不直接依赖了，而是通过一种“标记”来依赖。这不叫“不知道”！</p>
    </section>

    <section>
        <h1>通用实现：消息订阅中心</h1>
        <p>我们来实现一个消息订阅中心，发布者跟订阅者之间，通过“话题”来关联，类似微博话题。微博，就是我们的消息中心。</p>
        <a href="./weibo.ts" target="_blank">源码</a>
        <div>
            <iframe src="./weibo.html">
            </iframe>
        </div>
    </section>

    <section>
        <h1>变种</h1>
        <p>发布订阅者模式根据需求，可以有很多种变种。如加入命名空间（信道）、或者多实例来隔离不同模块之间的通讯污染；加入消息缓存，使订阅者可以接收到订阅前的消息等等。这些没什么好谈的，真的。</p>
    </section>
</body>

</html>